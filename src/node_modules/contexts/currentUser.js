import React, { createContext, useReducer } from 'react'

const initialState = {
    isLoading: false,
    isLoggedIn: null,
    currentUser: null
}

// reducer is a pattern from redux where reducer is just a function which update state by sepific action
const reducer = (state, action) => {
    switch (action.type) {
        case 'LOADING':
            return { ...state, isLoading: true }
        case 'SET_AUTHORIZED':
            return {
                ...state,
                isLoading: false,
                isLoggedIn: true,
                currentUser: action.payload
            }
        case 'SET_UNAUTHORIZED':
            return { ...state, isLoggedIn: false, currentUser: null }
        default:
            return state
    }
}



// context is some data which we can access from every component 
// so this our first context which current user context 
// it can created using creactContext function of react which take array of 2 elements which initial values like empty object and function 
export const CurrentUserContext = createContext()

// this is the component which will wrap all our component which is called children
export const CurrentUserProvider = ({ children }) => {
    const value = useReducer(reducer, initialState)

    // so here we have initialize our state object with some property which we pass below to all our children component and from where we can set state using setState hook which we are passing from below 
    return (
        // here also we can understand Provider as kind of property on createContext function as we create object out of it which is CurrentUserContext so we call it as below 
        <CurrentUserContext.Provider value={value}>
            {children}
        </CurrentUserContext.Provider>
    )
}